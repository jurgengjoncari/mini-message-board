<!--<div class="top-bar">-->
<!--  <h3 class="title">Mini Message Board</h3>-->
<!--  <div class="auth-actions">-->
<!--    @if (!isLoggedIn) {-->
<!--      <button (click)="showLogin()">Login</button>-->
<!--      <button (click)="showSignup()" class="signup">Sign Up</button>-->
<!--    } @else {-->
<!--      <button (click)="logout()" class="logout">Logout</button>-->
<!--    }-->
<!--  </div>-->
<!--</div>-->
<div class="chat-container">
  <div class="messages" #messagesContainer>
    @if (loading) {
      @for (i of [1, 2, 3, 4, 5]; track i) {
        <div class="chat-message loading"></div>
      }
    } @else {
      @for (group of messages | groupByDate; track group.key) {
        <div class="date-separator">{{ group.key }}</div>
        @for (msg of group.value; track msg._id) {
          <div [class]="'chat-message' + (msg.senderId?._id === currentUserId ? ' sent' : ' received')">
            <div class="chat-author">{{ msg.senderId?.username || '[deleted user]' }}</div>
            <div class="chat-content">{{ msg.content }}</div>
<!--              <div class="chat-time">{{ msg.createdAt | date:'HH:mm' }}</div>-->
          </div>
        }
      }
    }
  </div>
  <form class="chat-form">
    <div style="display: flex">
      <input
        #messageInput
        type="text"
        [(ngModel)]="newMessage"
        name="message"
        (keyup.enter)="sendMessage()"
        (focus)="onInputFocus()"
        placeholder="Type your message here..."
        class="chat-input"
        required
        [disabled]="loading"
      />
      <button type="button" (click)="sendMessage()" [disabled]="!isLoggedIn || loading || !newMessage.trim()">Send</button>
    </div>
<!--    @if (errorMessage) {-->
<!--      <div class="error">{{errorMessage}}</div>-->
<!--    }-->
  </form>
</div>
<app-auth
  [(visible)]="authVisible"
  [(mode)]="authMode"
  (loginSuccess)="onLoginSuccess()"
>
</app-auth>
